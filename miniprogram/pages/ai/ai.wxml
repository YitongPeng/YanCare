<!-- pages/ai/ai.wxml -->
<view class="ai-page">
  <!-- æ¶ˆæ¯åˆ—è¡¨ -->
  <view class="message-list">
    <view 
      class="message {{item.role}}"
      wx:for="{{messages}}"
      wx:key="index"
    >
      <view class="message-avatar {{item.role}}">
        {{item.role === 'user' ? 'æˆ‘' : 'ç‡•å„¿'}}
      </view>
      <view class="message-content">
        <text>{{item.content}}</text>
        <!-- æ“ä½œæŒ‰é’® -->
        <view class="action-btn" wx:if="{{item.action === 'GOTO_BOOKING'}}" bindtap="handleAction" data-action="{{item.action}}">
          ğŸ“… ç«‹å³é¢„çº¦
        </view>
        <!-- AIç”Ÿæˆæ ‡è¯† -->
        <view class="ai-tag" wx:if="{{item.role === 'assistant'}}">
          <text class="ai-icon">ğŸ¤–</text>
          <text>ç”±AIç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒ</text>
        </view>
      </view>
    </view>
    
    <!-- åŠ è½½ä¸­ -->
    <view class="message assistant" wx:if="{{loading}}">
      <view class="message-avatar assistant">ç‡•å„¿</view>
      <view class="message-content loading">
        <view class="dot"></view>
        <view class="dot"></view>
        <view class="dot"></view>
      </view>
    </view>
  </view>

  <!-- æ¨èé—®é¢˜ -->
  <view class="suggestions" wx:if="{{messages.length <= 1 && suggestions.length > 0}}">
    <view class="suggestions-title">æ‚¨å¯ä»¥è¿™æ ·é—®æˆ‘ï¼š</view>
    <view class="suggestion-list">
      <view 
        class="suggestion-item"
        wx:for="{{suggestions}}"
        wx:key="*this"
        bindtap="selectSuggestion"
        data-text="{{item}}"
      >
        {{item}}
      </view>
    </view>
  </view>

  <!-- è¾“å…¥åŒºåŸŸ -->
  <view class="input-area">
    <input 
      class="input-box"
      placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."
      value="{{inputText}}"
      bindinput="onInput"
      bindconfirm="sendMessage"
      confirm-type="send"
    />
    <button 
      class="send-btn {{canSend ? 'active' : ''}}" 
      bindtap="sendMessage"
      disabled="{{!canSend}}"
    >
      å‘é€
    </button>
  </view>
</view>
